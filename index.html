<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hotel Management System</title>
    <style>
        :root {
            --primary: #2c3e50;
            --secondary: #3498db;
            --light: #ecf0f1;
            --dark: #2c3e50;
            --success: #2ecc71;
            --danger: #e74c3c;
            --warning: #f39c12;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f5f5;
            color: var(--dark);
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background-color: var(--primary);
            color: white;
            padding: 15px 0;
            margin-bottom: 30px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        header .container {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            font-size: 24px;
            font-weight: bold;
        }
        
        nav ul {
            display: flex;
            list-style: none;
        }
        
        nav ul li {
            margin-left: 20px;
        }
        
        nav ul li a {
            color: white;
            text-decoration: none;
            padding: 5px 10px;
            border-radius: 4px;
            transition: background-color 0.3s;
        }
        
        nav ul li a:hover {
            background-color: rgba(255,255,255,0.2);
        }
        
        .card {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .card-header {
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
            margin-bottom: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .card-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--primary);
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        table th, table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }
        
        table th {
            background-color: var(--light);
            font-weight: 600;
        }
        
        .btn {
            padding: 8px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
        }
        
        .btn-primary {
            background-color: var(--secondary);
            color: white;
        }
        
        .btn-success {
            background-color: var(--success);
            color: white;
        }
        
        .btn-danger {
            background-color: var(--danger);
            color: white;
        }
        
        .btn-warning {
            background-color: var(--warning);
            color: white;
        }
        
        .btn:hover {
            opacity: 0.9;
            transform: translateY(-1px);
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
        }
        
        .form-control {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
        }
        
        .form-control:focus {
            outline: none;
            border-color: var(--secondary);
        }
        
        .row {
            display: flex;
            flex-wrap: wrap;
            margin: 0 -15px;
        }
        
        .col {
            flex: 1;
            padding: 0 15px;
        }
        
        .col-6 {
            flex: 0 0 50%;
            max-width: 50%;
        }
        
        .alert {
            padding: 15px;
            border-radius: 4px;
            margin-bottom: 20px;
        }
        
        .alert-success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .alert-danger {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .hidden {
            display: none;
        }
        
        .login-container {
            max-width: 400px;
            margin: 50px auto;
            padding: 30px;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .login-title {
            text-align: center;
            margin-bottom: 20px;
            color: var(--primary);
        }
        
        .login-btn {
            width: 100%;
            padding: 12px;
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s;
        }
        
        .login-btn:hover {
            background-color: var(--secondary);
        }
        
        .tab-container {
            margin-bottom: 20px;
        }
        
        .tabs {
            display: flex;
            border-bottom: 1px solid #ddd;
        }
        
        .tab {
            padding: 10px 20px;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            transition: all 0.3s;
        }
        
        .tab.active {
            border-bottom: 2px solid var(--secondary);
            color: var(--secondary);
            font-weight: 500;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .status-badge {
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
        }
        
        .status-reserved {
            background-color: #fff3cd;
            color: #856404;
        }
        
        .status-checked-in {
            background-color: #d4edda;
            color: #155724;
        }
        
        .status-checked-out {
            background-color: #d1ecf1;
            color: #0c5460;
        }
        
        .status-cancelled {
            background-color: #f8d7da;
            color: #721c24;
        }
        
        .bill-details {
            margin-top: 20px;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 4px;
        }
        
        .bill-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #eee;
        }
        
        .bill-total {
            font-weight: bold;
            font-size: 18px;
            margin-top: 10px;
        }
        
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        
        .modal-backdrop {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            z-index: 999;
        }
        
        .modal-content {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            z-index: 1001;
        }
        
        .modal-header {
            padding: 15px 20px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .modal-header h3 {
            margin: 0;
        }
        
        .modal-body {
            padding: 20px;
        }
        
        .modal-footer {
            padding: 15px 20px;
            border-top: 1px solid #eee;
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }
        
        .close-btn {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #777;
        }
        
        .btn-sm {
            padding: 5px 10px;
            font-size: 14px;
        }
        
        @media (max-width: 768px) {
            .col, .col-6 {
                flex: 0 0 100%;
                max-width: 100%;
            }
            
            nav ul {
                display: none;
            }
            
            .modal-content {
                width: 95%;
            }
        }
    </style>
</head>
<body>
    <!-- Login Screen -->
    <div id="login-screen" class="login-container">
        <h2 class="login-title">Hotel Management System</h2>
        <div class="form-group">
            <label for="login-username">Username</label>
            <input type="text" id="login-username" class="form-control" placeholder="Masukkan username">
        </div>
        <div class="form-group">
            <label for="login-password">Password</label>
            <input type="password" id="login-password" class="form-control" placeholder="Masukkan password">
        </div>
        <button id="login-btn" class="login-btn">Login</button>
        <div id="login-error" class="alert alert-danger hidden" style="margin-top: 15px;"></div>
    </div>

    <!-- Main App -->
    <div id="app" class="hidden">
        <header>
            <div class="container">
                <div class="logo">Hotel Management</div>
                <nav>
                    <ul>
                        <li><a href="#" data-tab="dashboard" class="active">Dashboard</a></li>
                        <li><a href="#" data-tab="reservations">Reservasi</a></li>
                        <li><a href="#" data-tab="check-in-out">Check-In/Out</a></li>
                        <li><a href="#" data-tab="services">Layanan</a></li>
                        <li id="admin-menu" class="hidden"><a href="#" data-tab="admin">Admin</a></li>
                        <li><a href="#" id="logout-btn">Logout</a></li>
                    </ul>
                </nav>
            </div>
        </header>

        <div class="container">
            <div id="alert-message" class="alert hidden"></div>

            <!-- Dashboard Tab -->
            <div id="dashboard" class="tab-content active">
                <h2>Dashboard</h2>
                <div class="row">
                    <div class="col">
                        <div class="card">
                            <div class="card-header">
                                <div class="card-title">Reservasi Hari Ini</div>
                            </div>
                            <div id="today-reservations">
                                <p>Memuat data...</p>
                            </div>
                        </div>
                    </div>
                    <div class="col">
                        <div class="card">
                            <div class="card-header">
                                <div class="card-title">Check-In Hari Ini</div>
                            </div>
                            <div id="today-checkins">
                                <p>Memuat data...</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col">
                        <div class="card">
                            <div class="card-header">
                                <div class="card-title">Check-Out Hari Ini</div>
                            </div>
                            <div id="today-checkouts">
                                <p>Memuat data...</p>
                            </div>
                        </div>
                    </div>
                    <div class="col">
                        <div class="card">
                            <div class="card-header">
                                <div class="card-title">Kamar Tersedia</div>
                            </div>
                            <div id="available-rooms">
                                <p>Memuat data...</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Reservations Tab -->
            <div id="reservations" class="tab-content">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">Reservasi Kamar</div>
                        <button id="add-reservation-btn" class="btn btn-primary">Tambah Reservasi</button>
                    </div>
                    <table id="reservations-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Nama Tamu</th>
                                <th>Kamar</th>
                                <th>Check-In</th>
                                <th>Check-Out</th>
                                <th>Status</th>
                                <th>Aksi</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Data akan diisi oleh JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Check-In/Out Tab -->
            <div id="check-in-out" class="tab-content">
                <div class="tab-container">
                    <div class="tabs">
                        <div class="tab active" data-tab="checkin">Check-In</div>
                        <div class="tab" data-tab="checkout">Check-Out</div>
                    </div>
                </div>

                <div id="checkin" class="tab-content active">
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">Daftar Reservasi untuk Check-In</div>
                        </div>
                        <table id="checkin-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Nama Tamu</th>
                                    <th>Kamar</th>
                                    <th>Check-In</th>
                                    <th>Check-Out</th>
                                    <th>Aksi</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Data akan diisi oleh JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <div id="checkout" class="tab-content">
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">Daftar Tamu untuk Check-Out</div>
                        </div>
                        <table id="checkout-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Nama Tamu</th>
                                    <th>Kamar</th>
                                    <th>Check-In</th>
                                    <th>Check-Out</th>
                                    <th>Aksi</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Data akan diisi oleh JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Services Tab -->
            <div id="services" class="tab-content">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">Layanan Tambahan</div>
                        <button id="add-service-btn" class="btn btn-primary">Tambah Layanan</button>
                    </div>
                    <table id="services-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Nama Layanan</th>
                                <th>Harga</th>
                                <th>Deskripsi</th>
                                <th>Aksi</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Data akan diisi oleh JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Admin Tab -->
            <div id="admin" class="tab-content">
                <div class="tab-container">
                    <div class="tabs">
                        <div class="tab active" data-tab="users">Manajemen Pengguna</div>
                        <div class="tab" data-tab="rooms">Manajemen Kamar</div>
                    </div>
                </div>

                <div id="users" class="tab-content active">
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">Daftar Pengguna</div>
                            <button id="add-user-btn" class="btn btn-primary">Tambah Pengguna</button>
                        </div>
                        <table id="users-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Username</th>
                                    <th>Nama</th>
                                    <th>Role</th>
                                    <th>Status</th>
                                    <th>Aksi</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Data akan diisi oleh JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <div id="rooms" class="tab-content">
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">Daftar Kamar</div>
                            <button id="add-room-btn" class="btn btn-primary">Tambah Kamar</button>
                        </div>
                        <table id="rooms-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Nomor Kamar</th>
                                    <th>Tipe</th>
                                    <th>Harga/Malam</th>
                                    <th>Status</th>
                                    <th>Aksi</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Data akan diisi oleh JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal Forms -->
        <div id="modal-backdrop" class="modal-backdrop hidden"></div>

        <!-- Reservation Form -->
        <div id="reservation-modal" class="modal hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="reservation-modal-title">Tambah Reservasi</h3>
                    <button class="close-btn">&times;</button>
                </div>
                <div class="modal-body">
                    <form id="reservation-form">
                        <input type="hidden" id="reservation-id">
                        <div class="row">
                            <div class="col">
                                <div class="form-group">
                                    <label for="guest-name">Nama Tamu</label>
                                    <input type="text" id="guest-name" class="form-control" required>
                                </div>
                                <div class="form-group">
                                    <label for="guest-phone">Telepon</label>
                                    <input type="text" id="guest-phone" class="form-control" required>
                                </div>
                                <div class="form-group">
                                    <label for="guest-email">Email</label>
                                    <input type="email" id="guest-email" class="form-control">
                                </div>
                            </div>
                            <div class="col">
                                <div class="form-group">
                                    <label for="room-type">Tipe Kamar</label>
                                    <select id="room-type" class="form-control" required>
                                        <option value="">Pilih Tipe Kamar</option>
                                        <option value="standard">Standard</option>
                                        <option value="deluxe">Deluxe</option>
                                        <option value="suite">Suite</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="checkin-date">Tanggal Check-In</label>
                                    <input type="date" id="checkin-date" class="form-control" required>
                                </div>
                                <div class="form-group">
                                    <label for="checkout-date">Tanggal Check-Out</label>
                                    <input type="date" id="checkout-date" class="form-control" required>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="special-requests">Permintaan Khusus</label>
                            <textarea id="special-requests" class="form-control" rows="3"></textarea>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-danger close-btn">Batal</button>
                            <button type="submit" class="btn btn-success">Simpan</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Service Form -->
        <div id="service-modal" class="modal hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="service-modal-title">Tambah Layanan</h3>
                    <button class="close-btn">&times;</button>
                </div>
                <div class="modal-body">
                    <form id="service-form">
                        <input type="hidden" id="service-id">
                        <div class="form-group">
                            <label for="service-name">Nama Layanan</label>
                            <input type="text" id="service-name" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="service-price">Harga</label>
                            <input type="number" id="service-price" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="service-description">Deskripsi</label>
                            <textarea id="service-description" class="form-control" rows="3"></textarea>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-danger close-btn">Batal</button>
                            <button type="submit" class="btn btn-success">Simpan</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- User Form -->
        <div id="user-modal" class="modal hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="user-modal-title">Tambah Pengguna</h3>
                    <button class="close-btn">&times;</button>
                </div>
                <div class="modal-body">
                    <form id="user-form">
                        <input type="hidden" id="user-id">
                        <div class="row">
                            <div class="col">
                                <div class="form-group">
                                    <label for="user-username">Username</label>
                                    <input type="text" id="user-username" class="form-control" required>
                                </div>
                                <div class="form-group">
                                    <label for="user-password">Password</label>
                                    <input type="password" id="user-password" class="form-control">
                                </div>
                            </div>
                            <div class="col">
                                <div class="form-group">
                                    <label for="user-name">Nama Lengkap</label>
                                    <input type="text" id="user-name" class="form-control" required>
                                </div>
                                <div class="form-group">
                                    <label for="user-role">Role</label>
                                    <select id="user-role" class="form-control" required>
                                        <option value="admin">Admin</option>
                                        <option value="receptionist">Resepsionis</option>
                                        <option value="staff">Staff</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="user-status">Status</label>
                            <select id="user-status" class="form-control" required>
                                <option value="active">Aktif</option>
                                <option value="inactive">Non-Aktif</option>
                            </select>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-danger close-btn">Batal</button>
                            <button type="submit" class="btn btn-success">Simpan</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Room Form -->
        <div id="room-modal" class="modal hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="room-modal-title">Tambah Kamar</h3>
                    <button class="close-btn">&times;</button>
                </div>
                <div class="modal-body">
                    <form id="room-form">
                        <input type="hidden" id="room-id">
                        <div class="row">
                            <div class="col">
                                <div class="form-group">
                                    <label for="room-number">Nomor Kamar</label>
                                    <input type="text" id="room-number" class="form-control" required>
                                </div>
                                <div class="form-group">
                                    <label for="room-type-modal">Tipe Kamar</label>
                                    <select id="room-type-modal" class="form-control" required>
                                        <option value="standard">Standard</option>
                                        <option value="deluxe">Deluxe</option>
                                        <option value="suite">Suite</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col">
                                <div class="form-group">
                                    <label for="room-price">Harga per Malam</label>
                                    <input type="number" id="room-price" class="form-control" required>
                                </div>
                                <div class="form-group">
                                    <label for="room-status">Status</label>
                                    <select id="room-status" class="form-control" required>
                                        <option value="available">Tersedia</option>
                                        <option value="occupied">Terisi</option>
                                        <option value="maintenance">Perbaikan</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="room-description">Deskripsi</label>
                            <textarea id="room-description" class="form-control" rows="3"></textarea>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-danger close-btn">Batal</button>
                            <button type="submit" class="btn btn-success">Simpan</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Check-In Form -->
        <div id="checkin-modal" class="modal hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Proses Check-In</h3>
                    <button class="close-btn">&times;</button>
                </div>
                <div class="modal-body">
                    <form id="checkin-form">
                        <input type="hidden" id="checkin-reservation-id">
                        <div class="form-group">
                            <label for="checkin-room">Kamar</label>
                            <select id="checkin-room" class="form-control" required>
                                <!-- Diisi oleh JavaScript -->
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="checkin-payment-method">Metode Pembayaran</label>
                            <select id="checkin-payment-method" class="form-control" required>
                                <option value="cash">Tunai</option>
                                <option value="credit_card">Kartu Kredit</option>
                                <option value="debit_card">Kartu Debit</option>
                                <option value="transfer">Transfer Bank</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="checkin-deposit">Deposit</label>
                            <input type="number" id="checkin-deposit" class="form-control" value="0">
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-danger close-btn">Batal</button>
                            <button type="submit" class="btn btn-success">Proses Check-In</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Check-Out Form -->
        <div id="checkout-modal" class="modal hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Proses Check-Out</h3>
                    <button class="close-btn">&times;</button>
                </div>
                <div class="modal-body">
                    <div id="guest-info">
                        <!-- Diisi oleh JavaScript -->
                    </div>
                    <div class="bill-details">
                        <h4>Detail Tagihan</h4>
                        <div id="bill-items">
                            <!-- Diisi oleh JavaScript -->
                        </div>
                        <div class="bill-row bill-total">
                            <span>Total:</span>
                            <span id="bill-total">Rp 0</span>
                        </div>
                    </div>
                    <form id="checkout-form">
                        <input type="hidden" id="checkout-reservation-id">
                        <div class="form-group">
                            <label for="checkout-payment-status">Status Pembayaran</label>
                            <select id="checkout-payment-status" class="form-control" required>
                                <option value="paid">Lunas</option>
                                <option value="partial">Sebagian</option>
                                <option value="unpaid">Belum Dibayar</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="checkout-amount-paid">Jumlah Dibayar</label>
                            <input type="number" id="checkout-amount-paid" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="checkout-notes">Catatan</label>
                            <textarea id="checkout-notes" class="form-control" rows="3"></textarea>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-danger close-btn">Batal</button>
                            <button type="submit" class="btn btn-success">Proses Check-Out</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Inisialisasi Data
        function initializeData() {
            // Cek apakah data sudah ada di localStorage
            if (!localStorage.getItem('hotelUsers')) {
                // Data pengguna default
                const users = [
                    {
                        id: 1,
                        username: 'admin',
                        password: 'admin123',
                        name: 'Administrator',
                        role: 'admin',
                        status: 'active'
                    },
                    {
                        id: 2,
                        username: 'reception',
                        password: 'reception123',
                        name: 'Resepsionis',
                        role: 'receptionist',
                        status: 'active'
                    }
                ];
                localStorage.setItem('hotelUsers', JSON.stringify(users));
            }

            if (!localStorage.getItem('hotelRooms')) {
                // Data kamar default
                const rooms = [
                    { id: 1, roomNumber: '101', type: 'standard', price: 500000, status: 'available', description: 'Kamar Standard' },
                    { id: 2, roomNumber: '102', type: 'standard', price: 500000, status: 'available', description: 'Kamar Standard' },
                    { id: 3, roomNumber: '201', type: 'deluxe', price: 750000, status: 'available', description: 'Kamar Deluxe' },
                    { id: 4, roomNumber: '202', type: 'deluxe', price: 750000, status: 'available', description: 'Kamar Deluxe' },
                    { id: 5, roomNumber: '301', type: 'suite', price: 1200000, status: 'available', description: 'Kamar Suite' }
                ];
                localStorage.setItem('hotelRooms', JSON.stringify(rooms));
            }

            if (!localStorage.getItem('hotelServices')) {
                // Data layanan default
                const services = [
                    { id: 1, name: 'Sarapan', price: 75000, description: 'Sarapan pagi' },
                    { id: 2, name: 'Laundry', price: 50000, description: 'Layanan laundry' },
                    { id: 3, name: 'Spa', price: 150000, description: 'Layanan spa' },
                    { id: 4, name: 'Transportasi', price: 100000, description: 'Layanan transportasi' }
                ];
                localStorage.setItem('hotelServices', JSON.stringify(services));
            }

            if (!localStorage.getItem('hotelReservations')) {
                // Data reservasi default
                const today = new Date();
                const tomorrow = new Date(today);
                tomorrow.setDate(today.getDate() + 1);
                const dayAfterTomorrow = new Date(today);
                dayAfterTomorrow.setDate(today.getDate() + 2);
                const threeDaysLater = new Date(today);
                threeDaysLater.setDate(today.getDate() + 3);

                const reservations = [
                    {
                        id: 1,
                        guestName: 'John Doe',
                        guestPhone: '08123456789',
                        guestEmail: 'john@example.com',
                        roomType: 'standard',
                        roomId: null,
                        checkInDate: tomorrow.toISOString().split('T')[0],
                        checkOutDate: threeDaysLater.toISOString().split('T')[0],
                        specialRequests: 'Tempat tidur tambahan',
                        status: 'reserved',
                        createdAt: today.toISOString()
                    },
                    {
                        id: 2,
                        guestName: 'Jane Smith',
                        guestPhone: '08987654321',
                        guestEmail: 'jane@example.com',
                        roomType: 'deluxe',
                        roomId: 3,
                        checkInDate: today.toISOString().split('T')[0],
                        checkOutDate: dayAfterTomorrow.toISOString().split('T')[0],
                        specialRequests: '',
                        status: 'checked-in',
                        paymentMethod: 'credit_card',
                        deposit: 1000000,
                        createdAt: new Date(today.setDate(today.getDate() - 1)).toISOString()
                    }
                ];
                localStorage.setItem('hotelReservations', JSON.stringify(reservations));
            }
        }

        // Fungsi Bantuan
        function formatDate(dateString) {
            if (!dateString) return '-';
            const options = { year: 'numeric', month: 'long', day: 'numeric' };
            return new Date(dateString).toLocaleDateString('id-ID', options);
        }

        function formatCurrency(amount) {
            return new Intl.NumberFormat('id-ID', { style: 'currency', currency: 'IDR' }).format(amount);
        }

        function showAlert(message, type = 'success') {
            const alert = document.getElementById('alert-message');
            alert.textContent = message;
            alert.className = `alert alert-${type}`;
            alert.classList.remove('hidden');
            
            setTimeout(() => {
                alert.classList.add('hidden');
            }, 5000);
        }

        // Fungsi untuk Modal
        function openModal(modalId) {
            document.getElementById('modal-backdrop').classList.remove('hidden');
            document.getElementById(modalId).classList.remove('hidden');
        }

        function closeModal() {
            document.getElementById('modal-backdrop').classList.add('hidden');
            document.querySelectorAll('.modal').forEach(modal => {
                modal.classList.add('hidden');
            });
        }

        // Fungsi untuk Tab
        function switchTab(tabId) {
            // Sembunyikan semua tab content
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Tampilkan tab yang dipilih
            document.getElementById(tabId).classList.add('active');
            
            // Update tab navigasi
            document.querySelectorAll('nav ul li a').forEach(link => {
                link.parentNode.classList.remove('active');
                if (link.dataset.tab === tabId) {
                    link.parentNode.classList.add('active');
                }
            });
            
            // Muat data untuk tab yang dipilih
            loadTabData(tabId);
        }

        function loadTabData(tabId) {
            switch(tabId) {
                case 'dashboard':
                    loadDashboard();
                    break;
                case 'reservations':
                    loadReservations();
                    break;
                case 'check-in-out':
                    loadCheckInOut();
                    break;
                case 'services':
                    loadServices();
                    break;
                case 'admin':
                    loadAdmin();
                    break;
            }
        }

        // Fungsi untuk Load Data
        function loadDashboard() {
            const today = new Date().toISOString().split('T')[0];
            const reservations = JSON.parse(localStorage.getItem('hotelReservations')) || [];
            
            // Reservasi hari ini
            const todayReservations = reservations.filter(res => 
                res.checkInDate === today && res.status === 'reserved'
            );
            
            document.getElementById('today-reservations').innerHTML = `
                <p>Total: ${todayReservations.length} reservasi</p>
                ${todayReservations.length > 0 ? `
                    <ul>
                        ${todayReservations.slice(0, 3).map(res => `
                            <li>${res.guestName} - Kamar ${res.roomType}</li>
                        `).join('')}
                    </ul>
                    ${todayReservations.length > 3 ? '<p>...dan ' + (todayReservations.length - 3) + ' lainnya</p>' : ''}
                ` : '<p>Tidak ada reservasi hari ini</p>'}
            `;
            
            // Check-in hari ini
            const todayCheckIns = reservations.filter(res => 
                res.checkInDate === today && res.status === 'checked-in'
            );
            
            document.getElementById('today-checkins').innerHTML = `
                <p>Total: ${todayCheckIns.length} check-in</p>
                ${todayCheckIns.length > 0 ? `
                    <ul>
                        ${todayCheckIns.slice(0, 3).map(res => `
                            <li>${res.guestName} - Kamar ${res.roomType}</li>
                        `).join('')}
                    </ul>
                    ${todayCheckIns.length > 3 ? '<p>...dan ' + (todayCheckIns.length - 3) + ' lainnya</p>' : ''}
                ` : '<p>Tidak ada check-in hari ini</p>'}
            `;
            
            // Check-out hari ini
            const todayCheckOuts = reservations.filter(res => 
                res.checkOutDate === today && (res.status === 'checked-in' || res.status === 'checked-out')
            );
            
            document.getElementById('today-checkouts').innerHTML = `
                <p>Total: ${todayCheckOuts.length} check-out</p>
                ${todayCheckOuts.length > 0 ? `
                    <ul>
                        ${todayCheckOuts.slice(0, 3).map(res => `
                            <li>${res.guestName} - Kamar ${res.roomType}</li>
                        `).join('')}
                    </ul>
                    ${todayCheckOuts.length > 3 ? '<p>...dan ' + (todayCheckOuts.length - 3) + ' lainnya</p>' : ''}
                ` : '<p>Tidak ada check-out hari ini</p>'}
            `;
            
            // Kamar tersedia
            const rooms = JSON.parse(localStorage.getItem('hotelRooms')) || [];
            const availableRooms = rooms.filter(room => room.status === 'available');
            
            document.getElementById('available-rooms').innerHTML = `
                <p>Total: ${availableRooms.length} kamar tersedia</p>
                ${availableRooms.length > 0 ? `
                    <ul>
                        ${availableRooms.slice(0, 3).map(room => `
                            <li>Kamar ${room.roomNumber} - ${room.type}</li>
                        `).join('')}
                    </ul>
                    ${availableRooms.length > 3 ? '<p>...dan ' + (availableRooms.length - 3) + ' lainnya</p>' : ''}
                ` : '<p>Tidak ada kamar tersedia</p>'}
            `;
        }

        function loadReservations() {
            const reservations = JSON.parse(localStorage.getItem('hotelReservations')) || [];
            const tbody = document.querySelector('#reservations-table tbody');
            
            tbody.innerHTML = reservations.map(res => `
                <tr>
                    <td>${res.id}</td>
                    <td>${res.guestName}</td>
                    <td>${res.roomId ? 'Kamar ' + (JSON.parse(localStorage.getItem('hotelRooms')).find(r => r.id === res.roomId)?.roomNumber || '') + ' (' + res.roomType + ')' : res.roomType}</td>
                    <td>${formatDate(res.checkInDate)}</td>
                    <td>${formatDate(res.checkOutDate)}</td>
                    <td><span class="status-badge status-${res.status}">${
                        res.status === 'reserved' ? 'Reservasi' : 
                        res.status === 'checked-in' ? 'Check-In' : 
                        res.status === 'checked-out' ? 'Check-Out' : 
                        'Dibatalkan'
                    }</span></td>
                    <td>
                        ${res.status === 'reserved' ? `
                            <button class="btn btn-success btn-sm" onclick="prepareCheckIn(${res.id})">Check-In</button>
                            <button class="btn btn-danger btn-sm" onclick="cancelReservation(${res.id})">Batal</button>
                        ` : ''}
                        <button class="btn btn-primary btn-sm" onclick="editReservation(${res.id})">Edit</button>
                        ${res.status === 'checked-in' ? `
                            <button class="btn btn-warning btn-sm" onclick="prepareCheckOut(${res.id})">Check-Out</button>
                        ` : ''}
                    </td>
                </tr>
            `).join('');
            
            if (reservations.length === 0) {
                tbody.innerHTML = '<tr><td colspan="7" style="text-align: center;">Tidak ada reservasi</td></tr>';
            }
        }

        function loadCheckInOut() {
            const today = new Date().toISOString().split('T')[0];
            const reservations = JSON.parse(localStorage.getItem('hotelReservations')) || [];
            
            // Reservasi untuk check-in
            const checkInReservations = reservations.filter(res => 
                res.status === 'reserved' && res.checkInDate <= today
            );
            
            const checkInTbody = document.querySelector('#checkin-table tbody');
            checkInTbody.innerHTML = checkInReservations.map(res => `
                <tr>
                    <td>${res.id}</td>
                    <td>${res.guestName}</td>
                    <td>${res.roomType}</td>
                    <td>${formatDate(res.checkInDate)}</td>
                    <td>${formatDate(res.checkOutDate)}</td>
                    <td>
                        <button class="btn btn-success btn-sm" onclick="prepareCheckIn(${res.id})">Check-In</button>
                    </td>
                </tr>
            `).join('');
            
            if (checkInReservations.length === 0) {
                checkInTbody.innerHTML = '<tr><td colspan="6" style="text-align: center;">Tidak ada reservasi untuk check-in hari ini</td></tr>';
            }
            
            // Tamu untuk check-out
            const checkOutGuests = reservations.filter(res => 
                res.status === 'checked-in' && res.checkOutDate <= today
            );
            
            const checkOutTbody = document.querySelector('#checkout-table tbody');
            checkOutTbody.innerHTML = checkOutGuests.map(res => `
                <tr>
                    <td>${res.id}</td>
                    <td>${res.guestName}</td>
                    <td>${res.roomId ? 'Kamar ' + (JSON.parse(localStorage.getItem('hotelRooms')).find(r => r.id === res.roomId)?.roomNumber || '') : res.roomType}</td>
                    <td>${formatDate(res.checkInDate)}</td>
                    <td>${formatDate(res.checkOutDate)}</td>
                    <td>
                        <button class="btn btn-warning btn-sm" onclick="prepareCheckOut(${res.id})">Check-Out</button>
                    </td>
                </tr>
            `).join('');
            
            if (checkOutGuests.length === 0) {
                checkOutTbody.innerHTML = '<tr><td colspan="6" style="text-align: center;">Tidak ada tamu untuk check-out hari ini</td></tr>';
            }
        }

        function loadServices() {
            const services = JSON.parse(localStorage.getItem('hotelServices')) || [];
            const tbody = document.querySelector('#services-table tbody');
            
            tbody.innerHTML = services.map(service => `
                <tr>
                    <td>${service.id}</td>
                    <td>${service.name}</td>
                    <td>${formatCurrency(service.price)}</td>
                    <td>${service.description || '-'}</td>
                    <td>
                        <button class="btn btn-primary btn-sm" onclick="editService(${service.id})">Edit</button>
                        <button class="btn btn-danger btn-sm" onclick="deleteService(${service.id})">Hapus</button>
                    </td>
                </tr>
            `).join('');
            
            if (services.length === 0) {
                tbody.innerHTML = '<tr><td colspan="5" style="text-align: center;">Tidak ada layanan tersedia</td></tr>';
            }
        }

        function loadAdmin() {
            // Load users
            const users = JSON.parse(localStorage.getItem('hotelUsers')) || [];
            const usersTbody = document.querySelector('#users-table tbody');
            
            usersTbody.innerHTML = users.map(user => `
                <tr>
                    <td>${user.id}</td>
                    <td>${user.username}</td>
                    <td>${user.name}</td>
                    <td>${user.role === 'admin' ? 'Admin' : user.role === 'receptionist' ? 'Resepsionis' : 'Staff'}</td>
                    <td>${user.status === 'active' ? 'Aktif' : 'Non-Aktif'}</td>
                    <td>
                        <button class="btn btn-primary btn-sm" onclick="editUser(${user.id})">Edit</button>
                        ${user.id !== currentUser.id ? `
                            <button class="btn btn-danger btn-sm" onclick="deleteUser(${user.id})">Hapus</button>
                        ` : ''}
                    </td>
                </tr>
            `).join('');
            
            if (users.length === 0) {
                usersTbody.innerHTML = '<tr><td colspan="6" style="text-align: center;">Tidak ada pengguna</td></tr>';
            }
            
            // Load rooms
            const rooms = JSON.parse(localStorage.getItem('hotelRooms')) || [];
            const roomsTbody = document.querySelector('#rooms-table tbody');
            
            roomsTbody.innerHTML = rooms.map(room => `
                <tr>
                    <td>${room.id}</td>
                    <td>${room.roomNumber}</td>
                    <td>${room.type === 'standard' ? 'Standard' : room.type === 'deluxe' ? 'Deluxe' : 'Suite'}</td>
                    <td>${formatCurrency(room.price)}</td>
                    <td>${
                        room.status === 'available' ? 'Tersedia' : 
                        room.status === 'occupied' ? 'Terisi' : 
                        'Perbaikan'
                    }</td>
                    <td>
                        <button class="btn btn-primary btn-sm" onclick="editRoom(${room.id})">Edit</button>
                        <button class="btn btn-danger btn-sm" onclick="deleteRoom(${room.id})">Hapus</button>
                    </td>
                </tr>
            `).join('');
            
            if (rooms.length === 0) {
                roomsTbody.innerHTML = '<tr><td colspan="6" style="text-align: center;">Tidak ada kamar</td></tr>';
            }
        }

        // Fungsi untuk CRUD Reservasi
        function addReservation() {
            document.getElementById('reservation-modal-title').textContent = 'Tambah Reservasi';
            document.getElementById('reservation-id').value = '';
            document.getElementById('reservation-form').reset();
            
            // Set default dates
            const today = new Date();
            const tomorrow = new Date(today);
            tomorrow.setDate(today.getDate() + 1);
            const tomorrowStr = tomorrow.toISOString().split('T')[0];
            
            document.getElementById('checkin-date').value = tomorrowStr;
            document.getElementById('checkout-date').value = tomorrowStr;
            
            openModal('reservation-modal');
        }

        function editReservation(id) {
            const reservations = JSON.parse(localStorage.getItem('hotelReservations')) || [];
            const reservation = reservations.find(res => res.id === id);
            
            if (reservation) {
                document.getElementById('reservation-modal-title').textContent = 'Edit Reservasi';
                document.getElementById('reservation-id').value = reservation.id;
                document.getElementById('guest-name').value = reservation.guestName;
                document.getElementById('guest-phone').value = reservation.guestPhone;
                document.getElementById('guest-email').value = reservation.guestEmail || '';
                document.getElementById('room-type').value = reservation.roomType;
                document.getElementById('checkin-date').value = reservation.checkInDate;
                document.getElementById('checkout-date').value = reservation.checkOutDate;
                document.getElementById('special-requests').value = reservation.specialRequests || '';
                
                openModal('reservation-modal');
            }
        }

        function saveReservation(e) {
            e.preventDefault();
            
            const id = document.getElementById('reservation-id').value;
            const guestName = document.getElementById('guest-name').value;
            const guestPhone = document.getElementById('guest-phone').value;
            const guestEmail = document.getElementById('guest-email').value;
            const roomType = document.getElementById('room-type').value;
            const checkInDate = document.getElementById('checkin-date').value;
            const checkOutDate = document.getElementById('checkout-date').value;
            const specialRequests = document.getElementById('special-requests').value;
            
            // Validate dates
            if (new Date(checkOutDate) <= new Date(checkInDate)) {
                showAlert('Tanggal check-out harus setelah tanggal check-in', 'danger');
                return;
            }
            
            let reservations = JSON.parse(localStorage.getItem('hotelReservations')) || [];
            
            if (id) {
                // Edit existing reservation
                const index = reservations.findIndex(res => res.id === parseInt(id));
                if (index !== -1) {
                    reservations[index] = {
                        ...reservations[index],
                        guestName,
                        guestPhone,
                        guestEmail,
                        roomType,
                        checkInDate,
                        checkOutDate,
                        specialRequests
                    };
                }
            } else {
                // Add new reservation
                const newId = reservations.length > 0 ? Math.max(...reservations.map(res => res.id)) + 1 : 1;
                reservations.push({
                    id: newId,
                    guestName,
                    guestPhone,
                    guestEmail,
                    roomType,
                    roomId: null,
                    checkInDate,
                    checkOutDate,
                    specialRequests,
                    status: 'reserved',
                    createdAt: new Date().toISOString()
                });
            }
            
            localStorage.setItem('hotelReservations', JSON.stringify(reservations));
            closeModal();
            showAlert('Reservasi berhasil disimpan');
            loadReservations();
            loadDashboard();
            loadCheckInOut();
        }

        function prepareCheckIn(reservationId) {
            const reservations = JSON.parse(localStorage.getItem('hotelReservations')) || [];
            const reservation = reservations.find(res => res.id === reservationId);
            
            if (reservation) {
                document.getElementById('checkin-reservation-id').value = reservation.id;
                
                // Load available rooms
                const rooms = JSON.parse(localStorage.getItem('hotelRooms')) || [];
                const availableRooms = rooms.filter(room => 
                    room.status === 'available' && room.type === reservation.roomType
                );
                
                const roomSelect = document.getElementById('checkin-room');
                roomSelect.innerHTML = availableRooms.length > 0 ? 
                    availableRooms.map(room => `
                        <option value="${room.id}">Kamar ${room.roomNumber} - ${room.type}</option>
                    `).join('') : '<option value="">Tidak ada kamar tersedia</option>';
                
                if (availableRooms.length === 0) {
                    showAlert('Tidak ada kamar tersedia untuk tipe ini', 'danger');
                    return;
                }
                
                openModal('checkin-modal');
            }
        }

        function processCheckIn(e) {
            e.preventDefault();
            
            const reservationId = parseInt(document.getElementById('checkin-reservation-id').value);
            const roomId = parseInt(document.getElementById('checkin-room').value);
            const paymentMethod = document.getElementById('checkin-payment-method').value;
            const deposit = parseFloat(document.getElementById('checkin-deposit').value) || 0;
            
            let reservations = JSON.parse(localStorage.getItem('hotelReservations')) || [];
            let rooms = JSON.parse(localStorage.getItem('hotelRooms')) || [];
            
            const resIndex = reservations.findIndex(res => res.id === reservationId);
            if (resIndex !== -1) {
                // Update reservation
                reservations[resIndex] = {
                    ...reservations[resIndex],
                    roomId,
                    status: 'checked-in',
                    paymentMethod,
                    deposit,
                    checkedInAt: new Date().toISOString()
                };
                
                // Update room status
                const roomIndex = rooms.findIndex(room => room.id === roomId);
                if (roomIndex !== -1) {
                    rooms[roomIndex].status = 'occupied';
                }
                
                localStorage.setItem('hotelReservations', JSON.stringify(reservations));
                localStorage.setItem('hotelRooms', JSON.stringify(rooms));
                
                closeModal();
                showAlert('Check-In berhasil diproses');
                loadReservations();
                loadCheckInOut();
                loadDashboard();
            }
        }

        function cancelReservation(id) {
            if (confirm('Apakah Anda yakin ingin membatalkan reservasi ini?')) {
                let reservations = JSON.parse(localStorage.getItem('hotelReservations')) || [];
                const index = reservations.findIndex(res => res.id === id);
                
                if (index !== -1) {
                    // If reservation has a room assigned, make it available again
                    if (reservations[index].roomId) {
                        let rooms = JSON.parse(localStorage.getItem('hotelRooms')) || [];
                        const roomIndex = rooms.findIndex(room => room.id === reservations[index].roomId);
                        if (roomIndex !== -1) {
                            rooms[roomIndex].status = 'available';
                            localStorage.setItem('hotelRooms', JSON.stringify(rooms));
                        }
                    }
                    
                    reservations[index].status = 'cancelled';
                    localStorage.setItem('hotelReservations', JSON.stringify(reservations));
                    showAlert('Reservasi berhasil dibatalkan');
                    loadReservations();
                    loadCheckInOut();
                    loadDashboard();
                }
            }
        }

        function prepareCheckOut(reservationId) {
            const reservations = JSON.parse(localStorage.getItem('hotelReservations')) || [];
            const reservation = reservations.find(res => res.id === reservationId);
            
            if (reservation) {
                document.getElementById('checkout-reservation-id').value = reservation.id;
                
                // Calculate bill
                const rooms = JSON.parse(localStorage.getItem('hotelRooms')) || [];
                const room = rooms.find(r => r.id === reservation.roomId);
                const services = JSON.parse(localStorage.getItem('hotelServices')) || [];
                
                // Calculate nights
                const checkInDate = new Date(reservation.checkInDate);
                const checkOutDate = new Date(reservation.checkOutDate);
                const nights = Math.ceil((checkOutDate - checkInDate) / (1000 * 60 * 60 * 24));
                
                // Room charges
                const roomCharges = room ? room.price * nights : 0;
                
                // Services charges (example, you might want to track actual services used)
                const serviceCharges = services.reduce((sum, service) => sum + service.price, 0);
                
                // Total
                const total = roomCharges + serviceCharges - (reservation.deposit || 0);
                
                // Display guest info
                document.getElementById('guest-info').innerHTML = `
                    <h4>Informasi Tamu</h4>
                    <p><strong>Nama:</strong> ${reservation.guestName}</p>
                    <p><strong>Kamar:</strong> ${room ? 'Kamar ' + room.roomNumber + ' (' + room.type + ')' : '-'}</p>
                    <p><strong>Check-In:</strong> ${formatDate(reservation.checkInDate)}</p>
                    <p><strong>Check-Out:</strong> ${formatDate(reservation.checkOutDate)}</p>
                    <p><strong>Deposit:</strong> ${formatCurrency(reservation.deposit || 0)}</p>
                `;
                
                // Display bill items
                document.getElementById('bill-items').innerHTML = `
                    <div class="bill-row">
                        <span>Biaya Kamar (${nights} malam @ ${room ? formatCurrency(room.price) : 'Rp 0'}):</span>
                        <span>${formatCurrency(roomCharges)}</span>
                    </div>
                    <div class="bill-row">
                        <span>Layanan Tambahan:</span>
                        <span>${formatCurrency(serviceCharges)}</span>
                    </div>
                    <div class="bill-row">
                        <span>Deposit:</span>
                        <span>-${formatCurrency(reservation.deposit || 0)}</span>
                    </div>
                `;
                
                // Display total
                document.getElementById('bill-total').textContent = formatCurrency(total > 0 ? total : 0);
                
                // Set amount paid
                document.getElementById('checkout-amount-paid').value = total > 0 ? total : 0;
                document.getElementById('checkout-payment-status').value = total <= 0 ? 'paid' : 'unpaid';
                
                openModal('checkout-modal');
            }
        }

        function processCheckOut(e) {
            e.preventDefault();
            
            const reservationId = parseInt(document.getElementById('checkout-reservation-id').value);
            const paymentStatus = document.getElementById('checkout-payment-status').value;
            const amountPaid = parseFloat(document.getElementById('checkout-amount-paid').value) || 0;
            const notes = document.getElementById('checkout-notes').value;
            
            let reservations = JSON.parse(localStorage.getItem('hotelReservations')) || [];
            let rooms = JSON.parse(localStorage.getItem('hotelRooms')) || [];
            
            const resIndex = reservations.findIndex(res => res.id === reservationId);
            if (resIndex !== -1) {
                // Update reservation
                reservations[resIndex] = {
                    ...reservations[resIndex],
                    status: 'checked-out',
                    paymentStatus,
                    amountPaid,
                    notes,
                    checkedOutAt: new Date().toISOString()
                };
                
                // Update room status
                const roomId = reservations[resIndex].roomId;
                if (roomId) {
                    const roomIndex = rooms.findIndex(room => room.id === roomId);
                    if (roomIndex !== -1) {
                        rooms[roomIndex].status = 'available';
                    }
                }
                
                localStorage.setItem('hotelReservations', JSON.stringify(reservations));
                localStorage.setItem('hotelRooms', JSON.stringify(rooms));
                
                closeModal();
                showAlert('Check-Out berhasil diproses');
                loadReservations();
                loadCheckInOut();
                loadDashboard();
            }
        }

        // Fungsi untuk CRUD Layanan
        function addService() {
            document.getElementById('service-modal-title').textContent = 'Tambah Layanan';
            document.getElementById('service-id').value = '';
            document.getElementById('service-form').reset();
            openModal('service-modal');
        }

        function editService(id) {
            const services = JSON.parse(localStorage.getItem('hotelServices')) || [];
            const service = services.find(s => s.id === id);
            
            if (service) {
                document.getElementById('service-modal-title').textContent = 'Edit Layanan';
                document.getElementById('service-id').value = service.id;
                document.getElementById('service-name').value = service.name;
                document.getElementById('service-price').value = service.price;
                document.getElementById('service-description').value = service.description || '';
                
                openModal('service-modal');
            }
        }

        function saveService(e) {
            e.preventDefault();
            
            const id = document.getElementById('service-id').value;
            const name = document.getElementById('service-name').value;
            const price = parseFloat(document.getElementById('service-price').value);
            const description = document.getElementById('service-description').value;
            
            if (!name || isNaN(price)) {
                showAlert('Nama dan harga harus diisi', 'danger');
                return;
            }
            
            let services = JSON.parse(localStorage.getItem('hotelServices')) || [];
            
            if (id) {
                // Edit existing service
                const index = services.findIndex(s => s.id === parseInt(id));
                if (index !== -1) {
                    services[index] = {
                        ...services[index],
                        name,
                        price,
                        description
                    };
                }
            } else {
                // Add new service
                const newId = services.length > 0 ? Math.max(...services.map(s => s.id)) + 1 : 1;
                services.push({
                    id: newId,
                    name,
                    price,
                    description
                });
            }
            
            localStorage.setItem('hotelServices', JSON.stringify(services));
            closeModal();
            showAlert('Layanan berhasil disimpan');
            loadServices();
        }

        function deleteService(id) {
            if (confirm('Apakah Anda yakin ingin menghapus layanan ini?')) {
                let services = JSON.parse(localStorage.getItem('hotelServices')) || [];
                services = services.filter(s => s.id !== id);
                localStorage.setItem('hotelServices', JSON.stringify(services));
                showAlert('Layanan berhasil dihapus');
                loadServices();
            }
        }

        // Fungsi untuk CRUD Pengguna
        function addUser() {
            document.getElementById('user-modal-title').textContent = 'Tambah Pengguna';
            document.getElementById('user-id').value = '';
            document.getElementById('user-password').required = true;
            document.getElementById('user-form').reset();
            openModal('user-modal');
        }

        function editUser(id) {
            const users = JSON.parse(localStorage.getItem('hotelUsers')) || [];
            const user = users.find(u => u.id === id);
            
            if (user) {
                document.getElementById('user-modal-title').textContent = 'Edit Pengguna';
                document.getElementById('user-id').value = user.id;
                document.getElementById('user-username').value = user.username;
                document.getElementById('user-password').required = false;
                document.getElementById('user-password').value = '';
                document.getElementById('user-name').value = user.name;
                document.getElementById('user-role').value = user.role;
                document.getElementById('user-status').value = user.status;
                
                openModal('user-modal');
            }
        }

        function saveUser(e) {
            e.preventDefault();
            
            const id = document.getElementById('user-id').value;
            const username = document.getElementById('user-username').value;
            const password = document.getElementById('user-password').value;
            const name = document.getElementById('user-name').value;
            const role = document.getElementById('user-role').value;
            const status = document.getElementById('user-status').value;
            
            if (!username || !name) {
                showAlert('Username dan nama harus diisi', 'danger');
                return;
            }
            
            let users = JSON.parse(localStorage.getItem('hotelUsers')) || [];
            
            // Check if username already exists (for new user)
            if (!id && users.some(u => u.username === username)) {
                showAlert('Username sudah digunakan', 'danger');
                return;
            }
            
            if (id) {
                // Edit existing user
                const index = users.findIndex(u => u.id === parseInt(id));
                if (index !== -1) {
                    users[index] = {
                        ...users[index],
                        username,
                        name,
                        role,
                        status
                    };
                    
                    // Update password if provided
                    if (password) {
                        users[index].password = password;
                    }
                }
            } else {
                // Add new user
                if (!password) {
                    showAlert('Password harus diisi untuk pengguna baru', 'danger');
                    return;
                }
                
                const newId = users.length > 0 ? Math.max(...users.map(u => u.id)) + 1 : 1;
                users.push({
                    id: newId,
                    username,
                    password,
                    name,
                    role,
                    status
                });
            }
            
            localStorage.setItem('hotelUsers', JSON.stringify(users));
            closeModal();
            showAlert('Pengguna berhasil disimpan');
            loadAdmin();
        }

        function deleteUser(id) {
            if (confirm('Apakah Anda yakin ingin menghapus pengguna ini?')) {
                let users = JSON.parse(localStorage.getItem('hotelUsers')) || [];
                users = users.filter(u => u.id !== id);
                localStorage.setItem('hotelUsers', JSON.stringify(users));
                showAlert('Pengguna berhasil dihapus');
                loadAdmin();
            }
        }

        // Fungsi untuk CRUD Kamar
        function addRoom() {
            document.getElementById('room-modal-title').textContent = 'Tambah Kamar';
            document.getElementById('room-id').value = '';
            document.getElementById('room-form').reset();
            openModal('room-modal');
        }

        function editRoom(id) {
            const rooms = JSON.parse(localStorage.getItem('hotelRooms')) || [];
            const room = rooms.find(r => r.id === id);
            
            if (room) {
                document.getElementById('room-modal-title').textContent = 'Edit Kamar';
                document.getElementById('room-id').value = room.id;
                document.getElementById('room-number').value = room.roomNumber;
                document.getElementById('room-type-modal').value = room.type;
                document.getElementById('room-price').value = room.price;
                document.getElementById('room-status').value = room.status;
                document.getElementById('room-description').value = room.description || '';
                
                openModal('room-modal');
            }
        }

        function saveRoom(e) {
            e.preventDefault();
            
            const id = document.getElementById('room-id').value;
            const roomNumber = document.getElementById('room-number').value;
            const type = document.getElementById('room-type-modal').value;
            const price = parseFloat(document.getElementById('room-price').value);
            const status = document.getElementById('room-status').value;
            const description = document.getElementById('room-description').value;
            
            if (!roomNumber || isNaN(price)) {
                showAlert('Nomor kamar dan harga harus diisi', 'danger');
                return;
            }
            
            let rooms = JSON.parse(localStorage.getItem('hotelRooms')) || [];
            
            // Check if room number already exists (for new room)
            if (!id && rooms.some(r => r.roomNumber === roomNumber)) {
                showAlert('Nomor kamar sudah digunakan', 'danger');
                return;
            }
            
            if (id) {
                // Edit existing room
                const index = rooms.findIndex(r => r.id === parseInt(id));
                if (index !== -1) {
                    rooms[index] = {
                        ...rooms[index],
                        roomNumber,
                        type,
                        price,
                        status,
                        description
                    };
                }
            } else {
                // Add new room
                const newId = rooms.length > 0 ? Math.max(...rooms.map(r => r.id)) + 1 : 1;
                rooms.push({
                    id: newId,
                    roomNumber,
                    type,
                    price,
                    status,
                    description
                });
            }
            
            localStorage.setItem('hotelRooms', JSON.stringify(rooms));
            closeModal();
            showAlert('Kamar berhasil disimpan');
            loadAdmin();
            loadDashboard();
            loadReservations();
            loadCheckInOut();
        }

        function deleteRoom(id) {
            if (confirm('Apakah Anda yakin ingin menghapus kamar ini?')) {
                // Check if room is used in any reservation
                const reservations = JSON.parse(localStorage.getItem('hotelReservations')) || [];
                const roomInUse = reservations.some(res => res.roomId === id && (res.status === 'reserved' || res.status === 'checked-in'));
                
                if (roomInUse) {
                    showAlert('Kamar tidak dapat dihapus karena sedang digunakan dalam reservasi', 'danger');
                    return;
                }
                
                let rooms = JSON.parse(localStorage.getItem('hotelRooms')) || [];
                rooms = rooms.filter(r => r.id !== id);
                localStorage.setItem('hotelRooms', JSON.stringify(rooms));
                showAlert('Kamar berhasil dihapus');
                loadAdmin();
                loadDashboard();
                loadReservations();
                loadCheckInOut();
            }
        }

        // Fungsi untuk Login/Logout
        function login() {
            const username = document.getElementById('login-username').value;
            const password = document.getElementById('login-password').value;
            
            if (!username || !password) {
                document.getElementById('login-error').textContent = 'Username dan password harus diisi';
                document.getElementById('login-error').classList.remove('hidden');
                return;
            }
            
            const users = JSON.parse(localStorage.getItem('hotelUsers')) || [];
            const user = users.find(u => u.username === username && u.password === password && u.status === 'active');
            
            if (user) {
                currentUser = user;
                document.getElementById('login-screen').classList.add('hidden');
                document.getElementById('app').classList.remove('hidden');
                
                // Show/hide admin menu based on role
                if (user.role === 'admin') {
                    document.getElementById('admin-menu').classList.remove('hidden');
                } else {
                    document.getElementById('admin-menu').classList.add('hidden');
                }
                
                // Load dashboard by default
                switchTab('dashboard');
            } else {
                document.getElementById('login-error').textContent = 'Username atau password salah';
                document.getElementById('login-error').classList.remove('hidden');
            }
        }

        function logout() {
            currentUser = null;
            document.getElementById('app').classList.add('hidden');
            document.getElementById('login-screen').classList.remove('hidden');
            document.getElementById('login-username').value = '';
            document.getElementById('login-password').value = '';
            document.getElementById('login-error').classList.add('hidden');
        }

        // Event Listeners
        document.addEventListener('DOMContentLoaded', function() {
            initializeData();
            
            // Login
            document.getElementById('login-btn').addEventListener('click', login);
            document.getElementById('login-password').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    login();
                }
            });
            
            // Logout
            document.getElementById('logout-btn').addEventListener('click', logout);
            
            // Navigation
            document.querySelectorAll('nav ul li a').forEach(link => {
                if (link.dataset.tab) {
                    link.addEventListener('click', function(e) {
                        e.preventDefault();
                        switchTab(this.dataset.tab);
                    });
                }
            });
            
            // Tab navigation
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    // Update tab navigation
                    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Show corresponding content
                    document.querySelectorAll('.tab-content').forEach(content => {
                        content.classList.remove('active');
                    });
                    
                    const tabId = this.dataset.tab;
                    document.getElementById(tabId).classList.add('active');
                    
                    // Load data if needed
                    if (tabId === 'checkin' || tabId === 'checkout') {
                        loadCheckInOut();
                    }
                });
            });
            
            // Modal close buttons
            document.querySelectorAll('.close-btn').forEach(btn => {
                btn.addEventListener('click', closeModal);
            });
            
            document.getElementById('modal-backdrop').addEventListener('click', closeModal);
            
            // Forms
            document.getElementById('reservation-form').addEventListener('submit', saveReservation);
            document.getElementById('service-form').addEventListener('submit', saveService);
            document.getElementById('user-form').addEventListener('submit', saveUser);
            document.getElementById('room-form').addEventListener('submit', saveRoom);
            document.getElementById('checkin-form').addEventListener('submit', processCheckIn);
            document.getElementById('checkout-form').addEventListener('submit', processCheckOut);
            
            // Buttons
            document.getElementById('add-reservation-btn').addEventListener('click', addReservation);
            document.getElementById('add-service-btn').addEventListener('click', addService);
            document.getElementById('add-user-btn').addEventListener('click', addUser);
            document.getElementById('add-room-btn').addEventListener('click', addRoom);
        });

        // Global variables
        let currentUser = null;
    </script>
</body>
</html>
